(this["webpackJsonptarang-example"]=this["webpackJsonptarang-example"]||[]).push([[0],[,,,,function(e,t,n){e.exports=n(11)},function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(5);var r=n(0),a=n.n(r),l=n(3),c=n.n(l),o=n(1);function u(e){let t=1;for(;e/2>1;)t*=2,e/=2;return t}const i={WIDTH:256,HEIGHT:256,CONTROLS_HEIGHT:30};Object.freeze(i);const s={WIDTH:1,HEIGHT:1};Object.freeze(s);const d={PLAYING:"PLAYING",STOPPED:"STOPPED",PAUSED:"PAUSED"};Object.freeze(d);var E={DEFAULT_DIMENSIONS:i,DEFAULT_DIMENSIONS_SCALE:s,PLAYING_STATUS:d},{getNextId:m}=function(){var e=0;return{getNextId:function(){return e<0?"id_0":"id_".concat(++e)}}}();const h={next:m};class g{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{...E.DEFAULT_DIMENSIONS},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.canvasId=e||h.next(),this.customScale=n,this.scale={...E.DEFAULT_DIMENSIONS_SCALE},t&&(this.dimensions=t,this.updateSvgWidthScale(),this.updateSvgHeightScale()),this.graph=null,!o)throw new Error("d3 is not found. Tarang may not behave as expected.");this.d3=o}init(){}update(){}clear(){this.graph&&this.graph.selectAll("*").remove()}updateSvgHeightScale(){let e=parseInt(.5*this.dimensions.WIDTH);this.dimensions.HEIGHT-e?this.scale.HEIGHT=Math.abs(this.dimensions.HEIGHT-e)/e*this.customScale:this.scale.HEIGHT=this.customScale}updateSvgWidthScale(){let e=u(.5*this.dimensions.WIDTH);this.dimensions.WIDTH-e?this.scale.WIDTH=Math.abs(this.dimensions.WIDTH-e)/e*this.customScale:this.scale.WIDTH=this.customScale}destroy(){this.clear(),this.graph.remove(),this.graph=null}}class H extends g{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1),this.BAR_PADDING=1}init(e){const{canvasId:t,customScale:n,dimensions:r,d3:a}=this;this.graph=a.select("#"+t).append("svg").attr("height",r.HEIGHT).attr("width",r.WIDTH).attr("class","my-1").attr("style",e).attr("id","bar_"+t+"_"+h.next())}update(e){const{BAR_PADDING:t,dimensions:n,graph:r,scale:a}=this;r.selectAll("rect").data(e).enter().append("rect").attr("fill",(function(e){return"#000"})).attr("width",n.WIDTH/e.length-t).attr("x",(function(t,r){return r*(n.WIDTH*a.WIDTH/e.length)})),r.selectAll("rect").data(e).attr("y",(function(e,t){return n.HEIGHT-e*a.HEIGHT})).attr("height",(function(e,t){return e*a.HEIGHT}))}}var b={tarangContainer:"_Bar-module__tarangContainer__2e-Ga",tarangSvgContainer:"_Bar-module__tarangSvgContainer__2FZ9m",tarangContorlsContainer:"_Bar-module__tarangContorlsContainer__3jS96",tarangControls:"_Bar-module__tarangControls__1NwDP"};const p=E.DEFAULT_DIMENSIONS,I=E.PLAYING_STATUS;class T extends g{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)}init(e){const{canvasId:t,customScale:n,dimensions:r,d3:a}=this;this.graph=a.select("#"+t).append("svg").attr("height",r.HEIGHT).attr("width",r.WIDTH).attr("class","my-1").attr("style","".concat(e)).attr("id","line_"+t+"_"+h.next())}update(e,t){const{dimensions:n,d3:r,graph:a,scale:l}=this;this.clear();var c=r.line().x((function(t,r){return r*n.WIDTH*l.WIDTH/e.length})).y((function(e){return n.HEIGHT-e*l.HEIGHT}));a.append("path").attr("d",c(e)).attr("stroke","black").attr("fill","none")}}var S={tarangContainer:"_Line-module__tarangContainer__3o1J3",tarangSvgContainer:"_Line-module__tarangSvgContainer__2EXZK",tarangContorlsContainer:"_Line-module__tarangContorlsContainer__3jk6n",tarangControls:"_Line-module__tarangControls__2RVnA"};const v=E.DEFAULT_DIMENSIONS,y=E.PLAYING_STATUS;const A={Bar:function(e){let{audioUrl:t,onEnded:n,loop:l=!1,coverArtUrl:c,width:o,height:u,controls:i=!1,muted:s=!1,volume:d=.8,scale:E=1,opacity:m}=e;const[g,T]=Object(r.useState)(""),[S,v]=Object(r.useState)(I.STOPPED),[y,A]=Object(r.useState)(h.next()),[O,U]=Object(r.useState)(p),[f,C]=Object(r.useState)(!1),[D,N]=Object(r.useState)(!0),_=Object(r.useRef)(new Audio),w=Object(r.useRef)(null),G=Object(r.useRef)(null),k=Object(r.useRef)(null),j=Object(r.useRef)(null);Object(r.useEffect)(()=>{N(i)},[i]),Object(r.useEffect)(()=>{L(),isNaN(o)||o==O.WIDTH||U(e=>({...e,WIDTH:o}))},[o]),Object(r.useEffect)(()=>{L(),isNaN(u)||u==O.HEIGHT||(i?u>2*O.CONTROLS_HEIGHT?U(e=>({...e,HEIGHT:u})):U(e=>({...e,HEIGHT:2*O.CONTROLS_HEIGHT})):U(e=>({...e,HEIGHT:u})))},[u,i]),Object(r.useEffect)(()=>{G.current&&w.current&&(f?G.current.disconnect(w.current.destination):G.current.connect(w.current.destination))},[f]),Object(r.useEffect)(()=>{C(s)},[s]),Object(r.useEffect)(()=>{_.current.volume=d},[d]),Object(r.useEffect)(()=>{S==I.PLAYING&&W()},[t]);const L=()=>{j.current&&j.current.clear()},P=e=>{j.current||(j.current=new H(y,O,E),j.current.init());const t=()=>{try{!_.current||_.current.paused?cancelAnimationFrame(t):(requestAnimationFrame(t),(e=>{k.current.getByteFrequencyData(e),j.current&&e.length&&j.current.update(e,m)})(e))}catch(n){console.error(n)}};t()},W=()=>{try{if(!t)return;g!=t&&(_.current.src?T(_.current.src):T(t),S==I.PLAYING&&x(),w.current||(w.current=new(window.AudioContext||window.webkitAudioContext)),_.current?_.current.src=t:_.current=new Audio(t),_.current.crossOrigin="anonymous",G.current||(G.current=w.current.createMediaElementSource(_.current)),_.current.volume=d,_.current.load(),_.current.onended=e=>{L(),l?W():"function"==typeof n&&(v(I.STOPPED),n())},k.current=w.current.createAnalyser(),G.current.connect(k.current),f||G.current.connect(w.current.destination)),v(I.PLAYING),k.current.fftSize=O.WIDTH;const e=k.current.frequencyBinCount,r=new Uint8Array(e);k.current.getByteFrequencyData(r),_.current.play(),P(r)}catch(e){console.error(e)}},x=()=>{v(I.STOPPED),_.current.pause(),_.current.currentTime=0,L()},F=()=>{D||S||W()},R=()=>{D||S&&x()};return a.a.createElement(r.Fragment,null,a.a.createElement("div",{onMouseEnter:F,onFocus:F,onPointerEnter:F,onMouseLeave:R,onBlur:R,onPointerLeave:F,className:" ".concat(b.tarangContainer," ","tarang-bar"),style:{width:O.WIDTH,height:D?O.HEIGHT+O.CONTROLS_HEIGHT:O.HEIGHT,backgroundImage:"linear-gradient(to bottom, #aaa6, #aaad), url(".concat(c,")")}},a.a.createElement("div",{className:b.tarangSvgContainer,id:y,style:{width:O.WIDTH,height:O.HEIGHT}}),D?a.a.createElement("div",{className:b.tarangContorlsContainer,style:{height:O.CONTROLS_HEIGHT}},S!=I.PLAYING?a.a.createElement("button",{className:" ".concat(b.tarangControls," ",b.tarangControlPlay),onClick:W},"Play"):null,S==I.PLAYING?a.a.createElement("button",{className:" ".concat(b.tarangControls," ",b.tarangControlStop),onClick:()=>{v(I.PAUSED),_.current.pause()}},"Pause"):null,a.a.createElement("button",{className:" ".concat(b.tarangControls," ",b.tarangControlStop),onClick:x},"Stop"),a.a.createElement("button",{className:" ".concat(b.tarangControls," ",b.tarangControlMute),onClick:()=>{C(!f)}},f?"Unmute":"Mute")):null))},Line:function(e){let{audioUrl:t,onEnded:n,loop:l=!1,coverArtUrl:c,width:o,height:u,controls:i=!1,muted:s=!1,volume:d=.8,scale:E=1,opacity:m}=e;const[g,H]=Object(r.useState)(""),[b,p]=Object(r.useState)(y.STOPPED),[I,A]=Object(r.useState)(h.next()),[O,U]=Object(r.useState)(v),[f,C]=Object(r.useState)(!0),[D,N]=Object(r.useState)(!0),_=Object(r.useRef)(new Audio),w=Object(r.useRef)(null),G=Object(r.useRef)(null),k=Object(r.useRef)(null),j=Object(r.useRef)(null);Object(r.useEffect)(()=>{C(i)},[i]),Object(r.useEffect)(()=>{L(),isNaN(o)||o==O.WIDTH||U(e=>({...e,WIDTH:o}))},[o]),Object(r.useEffect)(()=>{L(),isNaN(u)||u==O.HEIGHT||(i?u>2*O.CONTROLS_HEIGHT?U(e=>({...e,HEIGHT:u})):U(e=>({...e,HEIGHT:2*O.CONTROLS_HEIGHT})):U(e=>({...e,HEIGHT:u})))},[u,i]),Object(r.useEffect)(()=>{G.current&&w.current&&(D?G.current.disconnect(w.current.destination):G.current.connect(w.current.destination))},[D]),Object(r.useEffect)(()=>{N(s)},[s]),Object(r.useEffect)(()=>{_.current.volume=d},[d]),Object(r.useEffect)(()=>{b==y.PLAYING&&W()},[t]);const L=()=>{j.current&&j.current.clear()},P=e=>{j.current||(j.current=new T(I,O,E),j.current.init());const t=()=>{try{!_.current||_.current.paused?cancelAnimationFrame(t):(requestAnimationFrame(t),(e=>{k.current.getByteFrequencyData(e),j.current&&e.length&&j.current.update(e,m)})(e))}catch(n){console.error(n)}};t()},W=()=>{try{if(!t)return;g!=t&&(_.current.src?H(_.current.src):H(t),b==y.PLAYING&&x(),w.current||(w.current=new(window.AudioContext||window.webkitAudioContext)),_.current?_.current.src=t:_.current=new Audio(t),_.current.crossOrigin="anonymous",G.current||(G.current=w.current.createMediaElementSource(_.current)),_.current.volume=d,_.current.load(),_.current.onended=e=>{L(),l&&W(),"function"==typeof n&&(p(y.STOPPED),n())},k.current=w.current.createAnalyser(),G.current.connect(k.current),D||G.current.connect(w.current.destination)),p(y.PLAYING),k.current.fftSize=O.WIDTH;const e=k.current.frequencyBinCount,r=new Uint8Array(e);k.current.getByteFrequencyData(r),_.current.play(),P(r)}catch(e){console.error(e)}},x=()=>{p(y.STOPPED),_.current.pause(),L(),_.current.currentTime=0},F=()=>{f||b||W()},R=()=>{f||b&&x()};return a.a.createElement(r.Fragment,null,a.a.createElement("div",{onMouseEnter:F,onFocus:F,onPointerEnter:F,onMouseLeave:R,onBlur:R,onPointerLeave:F,className:" ".concat(S.tarangContainer," ","tarang-line"),style:{width:O.WIDTH,height:f?O.HEIGHT+O.CONTROLS_HEIGHT:O.HEIGHT,background:"linear-gradient(to bottom, #aaa6, #aaad), url(".concat(c,")")}},a.a.createElement("div",{className:S.tarangSvgContainer,id:I,style:{width:O.WIDTH,height:O.HEIGHT}}),f?a.a.createElement("div",{className:S.tarangContorlsContainer,style:{height:O.CONTROLS_HEIGHT}},b!=y.PLAYING?a.a.createElement("button",{className:" ".concat(S.tarangControls," ",S.tarangControlPlay),onClick:W},"Play"):null,b==y.PLAYING?a.a.createElement("button",{className:" ".concat(S.tarangControls," ",S.tarangControlPlay),onClick:()=>{p(y.PAUSED),_.current.pause()}},"Pause"):null,a.a.createElement("button",{className:" ".concat(S.tarangControls," ",S.tarangControlStop),onClick:x},"Stop"),a.a.createElement("button",{className:" ".concat(S.tarangControls," ",S.tarangControlMute),onClick:()=>{N(!D)}},D?"Unmute":"Mute")):null))},utils:{binaryCeil:function(e){let t=1;do{t*=2,e/=2}while(e/2>0);return t},binaryFloor:u},SvgHandler:g,...E};n(10);var O=()=>a.a.createElement("a",{href:"https://www.npmjs.com/package/tarang"},"npm");var U=()=>a.a.createElement("a",{href:"https://github.com/kamalyesh/tarang/blob/master/README.md"},"README");var f=()=>{const e=[{audioUrl:"https://tarang.surge.sh/audio/example.mp3",coverArtUrl:"https://tarang.surge.sh/images/example-cover.png"}],[t,n]=Object(r.useState)([...e]),[l,c]=Object(r.useState)(0),[o,u]=Object(r.useState)(""),[i,s]=Object(r.useState)(""),[d,E]=Object(r.useState)(!0),[m,h]=Object(r.useState)(!0),[g,H]=Object(r.useState)(A.DEFAULT_DIMENSIONS),[b,p]=Object(r.useState)(A.DEFAULT_DIMENSIONS),[I,T]=Object(r.useState)(!1),[S,v]=Object(r.useState)(!1),y=e=>{let t=e.split("/");return t.length?t[t.length-1]:t};return a.a.createElement("section",null,a.a.createElement("table",null,a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("legend",null,"Playlist"),a.a.createElement("table",{style:{position:"relative",width:"400px",height:"fit-content"}},a.a.createElement("tbody",null,t.map((e,t)=>a.a.createElement("tr",{key:JSON.stringify(e).length+"_"+t,style:{textDecoration:"link",cursor:"pointer"}},a.a.createElement("td",null,a.a.createElement("button",{onClick:()=>{c(t)}},y(e.audioUrl)))))||null,a.a.createElement("tr",null,a.a.createElement("td",{style:{display:"flex",flexWrap:"wrap"}},a.a.createElement("input",{style:{width:"90%",display:"block"},type:"url",value:o,onChange:e=>u(e.target.value),placeholder:"Enter mp3 url"}),a.a.createElement("input",{style:{width:"90%",display:"block"},type:"url",value:i,onChange:e=>s(e.target.value),placeholder:"Enter cover art url"})),a.a.createElement("td",{style:{display:"flex",flexWrap:"wrap"}},a.a.createElement("button",{type:"button",onClick:()=>{o&&n(t.concat([{audioUrl:o,coverArtUrl:i||"#"}]))},style:{display:"block"}},"Set"),a.a.createElement("button",{onClick:()=>{n([e[0]]),c(0),u(""),s("")},style:{display:"block"}},"Reset"))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement(U,null)),a.a.createElement("td",null,a.a.createElement(O,null)))))))),a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("legend",null,"Now Playing"),a.a.createElement("table",{style:{position:"relative",width:"400px",height:"100px",maxHeight:"300px",overflowY:"scroll"}},a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("th",null,y(t[l].audioUrl))))))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("legend",null,"Virtualization as Line Graph"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("label",{htmlFor:"line-control"},"Show Controls",a.a.createElement("input",{type:"checkbox",onChange:e=>E(e.target.checked),id:"line-control",checked:d})))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("div",{title:JSON.stringify({width:g.WIDTH,height:g.HEIGHT,controls:d,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:.7},null,4)},I?null:a.a.createElement(A.Line,{width:g.WIDTH,height:g.HEIGHT,controls:d,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:.7}))))))),a.a.createElement("td",null,a.a.createElement("legend",null,"Virtualization as Bar Graph"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("label",{htmlFor:"bar-control"},"Show Controls",a.a.createElement("input",{type:"checkbox",onChange:e=>h(e.target.checked),id:"bar-control",checked:m})))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("div",{title:JSON.stringify({width:b.WIDTH,height:b.HEIGHT,controls:m,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:.7},null,4)},S?null:a.a.createElement(A.Bar,{width:b.WIDTH,height:b.HEIGHT,controls:m,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:.7})))))))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("legend",null,"Virtualization as Line Graph (halved)"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("label",{htmlFor:"line-control"},"Show Controls",a.a.createElement("input",{type:"checkbox",onChange:e=>E(e.target.checked),id:"line-control",checked:d})))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("div",{style:{float:"right"},title:JSON.stringify({width:g.WIDTH,height:g.HEIGHT/2,controls:d,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:.5},null,4)},I?null:a.a.createElement(A.Line,{width:g.WIDTH,height:g.HEIGHT/2,controls:d,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:.5}))))))),a.a.createElement("td",null,a.a.createElement("legend",null,"Virtualization as Bar Graph (halved)"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("label",{htmlFor:"bar-control"},"Show Controls",a.a.createElement("input",{type:"checkbox",onChange:e=>h(e.target.checked),id:"bar-control",checked:m})))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("div",{title:JSON.stringify({width:b.WIDTH,height:b.HEIGHT/2,controls:m,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:.5},null,4)},S?null:a.a.createElement(A.Bar,{width:b.WIDTH,height:b.HEIGHT/2,controls:m,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:.5})))))))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("legend",null,"Virtualization as Line Graph (scaled)"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("label",{htmlFor:"line-control"},"Show Controls",a.a.createElement("input",{type:"checkbox",onChange:e=>E(e.target.checked),id:"line-control",checked:d})))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("div",{title:JSON.stringify({width:g.WIDTH,controls:d,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:1.1},null,4)},I?null:a.a.createElement(A.Line,{width:g.WIDTH,controls:d,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:1.1}))))))),a.a.createElement("td",null,a.a.createElement("legend",null,"Virtualization as Bar Graph (scaled)"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("label",{htmlFor:"bar-control"},"Show Controls",a.a.createElement("input",{type:"checkbox",onChange:e=>h(e.target.checked),id:"bar-control",checked:m})))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("div",{title:JSON.stringify({width:b.WIDTH,controls:m,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:1.1},null,4)},S?null:a.a.createElement(A.Bar,{width:b.WIDTH,controls:m,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:1.1})))))))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("legend",null,"Virtualization as Line Graph (on loop - please note that loop and onEnded are mutually exclusive)"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("label",{htmlFor:"line-control"},"Show Controls",a.a.createElement("input",{type:"checkbox",onChange:e=>E(e.target.checked),id:"line-control",checked:d})))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("div",{title:JSON.stringify({loop:!0,width:g.WIDTH,controls:d,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:1.1},null,4)},I?null:a.a.createElement(A.Line,{loop:!0,width:g.WIDTH,controls:d,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:1.1}))))))),a.a.createElement("td",null,a.a.createElement("legend",null,"Virtualization as Bar Graph (event on end - please note that loop and onEnded are mutually exclusive)"),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("label",{htmlFor:"bar-control"},"Show Controls",a.a.createElement("input",{type:"checkbox",onChange:e=>h(e.target.checked),id:"bar-control",checked:m})))),a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement("div",{title:JSON.stringify({onEnded:'{() => alert("song ended")}',width:b.WIDTH,controls:m,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:1.1},null,4)},S?null:a.a.createElement(A.Bar,{onEnded:()=>alert("song ended"),width:b.WIDTH,controls:m,audioUrl:t[l].audioUrl,coverArtUrl:t[l].coverArtUrl,scale:1.1})))))))))))};var C=()=>a.a.createElement("div",{className:"App",style:{backgroundColor:"lightsteelblue"}},a.a.createElement(f,null));c.a.render(a.a.createElement(C,null),document.getElementById("root"))}],[[4,1,2]]]);
//# sourceMappingURL=main.5206ae7d.chunk.js.map